<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords"
        content="PORPOISE, Proof of Reputation, Protocol, zero knowledge proof, zkSNARK, crypto, Mina Protocol, Protokit, surveys, predictions">
    <meta name="description" content="Make a PORPOISE Survey">
    <title>PORPOISE Network</title>

    <style>
        body {
            background-color: #000;
            color: #0ff;
            /* Light blue font color */
            font-family: 'Courier New', monospace;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        header {
            padding: 50px;
        }

        h1 {
            font-size: 3em;
            margin: 10px;
        }

        p {
            font-size: 1.2em;
            margin: 20px;
        }

        /* visited link */
        a[href]:visited {
            color: #00d0ff;
        }

        /* mouse over link */
        a[href]:hover {
            color: #00ddff;
        }

        /* unvisited link */
        a[href] {
            color: #0ff;
            text-decoration: none;
        }

        footer {
            padding: 20px;
        }

        header img {
            width: 2.5em;
            /* Set the width to match the font size */
            height: 1em;
            /* Set the height to match the font size */
        }
    </style>

    <script>

        const urlPrefix = 'https://porpoise.network/take-survey.html?';
        const urlEncodedDolphin = '%F0%9F%90%AC';
        const urlEncodedAlarmClock = '%E2%8F%B0';
        const urlEncodedCrystalBall = '%F0%9F%94%AE';
        const urlEncodedBallotBox = '%F0%9F%97%B3';

        function generateLink() {
            const dolphin = document.getElementById('üê¨input').value;
            const date = document.getElementById('‚è∞date').value;
            const time = document.getElementById('‚è∞time').value;
            const oracle = document.getElementById('üîÆinput').value;
            const option1 = document.getElementById('üó≥1input').value;
            const option2 = document.getElementById('üó≥2input').value;

            console.log("Dolphin: ", dolphin);
            console.log("Date: ", date);
            console.log("Time: ", time);
            console.log("Oracle: ", oracle);
            console.log("Option1: ", option1);
            console.log("Option2: ", option2);

            const deadline = dateTimeToTimestamp(date,time);
            console.log("Deadline: ", deadline);

            if (dolphin === '' || date === '' || time === '' || oracle === '' || option1 === '' || option2 === '') {
                document.getElementById('surveyURL').innerHTML = "You must enter something in each field to generate a link."
                return 0;
            }

            const surveyURL = urlPrefix + urlEncodedDolphin + "=" + dolphin.replace(/\s+/g, '-') + '&' +
            urlEncodedAlarmClock + '=' + deadline + '&' +
            urlEncodedCrystalBall + '=' + oracle.replace(/\s+/g, '-') + '&' +
            urlEncodedBallotBox + '1=' + option1.replace(/\s+/g, '-') + '&' +
            urlEncodedBallotBox + '2=' + option2.replace(/\s+/g, '-');
            console.log("Survey URL:", surveyURL);

            document.getElementById('surveyURL').innerHTML = surveyURL.slice(0,50) + "...";
            document.getElementById('surveyLink').setAttribute('href', surveyURL);

            return 1;
        }

        function dateTimeToTimestamp(dateString, timeString) {
            // Combine the date and time strings into a single string
            const combinedDateTimeString = `${dateString}T${timeString}:00Z`;

            // Create a Date object from the combined string (assuming the input is in "YYYY-MM-DDTHH:mm" format)
            const dateTime = new Date(combinedDateTimeString);

            // Get the UTC timestamp in milliseconds
            const utcTimestamp = dateTime.getTime();

            return utcTimestamp;
        }

        function convertUTCtoDate(utcTimestamp) {
            // Create a new Date object with the UTC timestamp
            // the UTC timestamp should be in miliseconds
            const date = new Date(parseInt(utcTimestamp, 10));

            // Get the individual components of the date and time
            const year = date.getUTCFullYear();
            const month = date.getUTCMonth() + 1; // Months are zero-indexed, so add 1
            const day = date.getUTCDate();
            const hours = date.getUTCHours();
            const minutes = date.getUTCMinutes();
            const seconds = date.getUTCSeconds();

            const formattedDateTime = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;

            return formattedDateTime;
        }
    </script>
</head>

<body>
    <header>
        <h1><a href="/">PORPOISE</a> Survey Creator:</h1>
    </header>

    <div id="üê¨">
        <h2>Enter your survey text (avoid special characters).</h2>
        üê¨: <input type="text" id="üê¨input" placeholder="Enter text...">
    </div>

    <div id="‚è∞">
        <h2>Pick a deadline for predictions to be committed.</h2>
        <label for="‚è∞date">‚è∞:</label><input type="date" id="‚è∞date" name="myDate"> <input type="time" id="‚è∞time"
            name="time">
    </div>

    <div id="üîÆ">
        <h2>Enter a contract address that will serve as the event result oracle.</h2>
        üîÆ: <input type="text" id="üîÆinput" placeholder="Enter an address...">
    </div>

    <div id="üó≥">
        <h2>Set event outcome options:</h2>
        <p id="üó≥1">
            üó≥1: <input type="text" id="üó≥1input" placeholder="Enter an outcome...">
        </p>
        <p id="üó≥2">
            üó≥2: <input type="text" id="üó≥2input" placeholder="Enter an outcome...">
        </p>
    </div>

    <div>
        <h2>
            Generate Survey Link
        </h2>
        <button onclick="generateLink()">üê¨!</button>
        <a id="surveyLink" target="_blank"><p id="surveyURL"></p></a>
    </div>

    <footer>
        <p>
            &copy; 2024 PORPOISE Network. All rights reserved.
        </p>
    </footer>
</body>

</html>