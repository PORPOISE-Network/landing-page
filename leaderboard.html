<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords"
        content="PORPOISE, Proof of Reputation, Protocol, zero knowledge proof, zkSNARK, crypto, Mina Protocol, Protokit, survey, prediction">
    <meta name="description" content="Proof of Reputation Protocol">
    <title>PORPOISE Network</title>

    <script>
        const leaderboardLink = 'https://zkporpoise.replit.app/fetch-leaderboard';

        // Function to generate table rows from responsesData
        function generateTableRows() {
            fetch(leaderboardLink)
                .then((response) => {
                    if (!response.ok) {
                        throw new Error("Network response was not ok.")
                    } else {
                        return response.json();
                    }
                })
                .then((output) => {
                    const tableBody = document.getElementById('tableBody');
                    Object.keys(output).forEach((key) => {
                        let newRow = document.createElement('tr');
                        newRow.innerHTML = `<td>${key}</td><td>${output[key].numberofresponses}</td><td>${output[key].numberofcorrectresponses}</td><td>${output[key].score}</td>`
                        tableBody.appendChild(newRow);
                    });
                })
                .catch((err) => {
                    // TODO: put some logic here to surface the error
                    console.log("ERROR Registering Passkey: ", err);
                });
        }
    </script>

    <link rel="stylesheet" href="take-survey.css">
</head>

<body onload="generateTableRows()">
    <header>
        <div id="username" title="Username">ü•∏:__</div>
        <div id="menu" title="üê¨ Home Menu"><a href="/">PORPOISE</a></div>
    </header>

    <h2 id="üê¨">
        <p>üê¨ Resurrecting the dead internet.</p>
    </h2>

    <br>
    <h2 id="üê¨"> LEADERBOARD </h2>
    <div id="tableContainer">
        <table>
            <thead>
                <tr>
                    <th>Username</th>
                    <th># of Responses</th>
                    <th># Correct Responses</th>
                    <th>Score</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>
    <footer style="position: fixed; bottom: 0; width: 100%; text-align: center;">
        <p>
            &copy; ‚è∞2024 üîÆPORPOISE Network.
        </p>
    </footer>
</body>

</html>